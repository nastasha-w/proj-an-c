#ifndef TWODIMS
#define  NORM_COEFF  (4.0/3*M_PI)                 /*!< Coefficient for kernel normalization. Note:  4.0/3 * PI = 4.188790204786 */
#else
#define  NORM_COEFF  M_PI                         /*!< Coefficient for kernel normalization. */
#endif

#define ONETHIRD   (1.0/3)
#define TWOTHIRDS  (2.0/3)

#ifdef SPH_KERNEL_GADGET
#define HSML_FACTOR     2.0
#define HSML_FACTOR_INV (1.0/HSML_FACTOR)
#endif

#ifdef SPH_KERNEL_CUBIC
#ifndef TWODIMS
#define HSML_FACTOR     1.825742
#else
#define HSML_FACTOR     1.778002
#endif
#define HSML_FACTOR_INV (1.0/HSML_FACTOR)
#endif

#ifdef SPH_KERNEL_QUARTIC
#ifndef TWODIMS
#define HSML_FACTOR     2.018932
#else
#define HSML_FACTOR     1.977173
#endif
#define HSML_FACTOR_INV (1.0/HSML_FACTOR)
#endif

#ifdef SPH_KERNEL_QUINTIC
#ifndef TWODIMS
#define HSML_FACTOR     2.195775
#else
#define HSML_FACTOR     2.158131
#endif
#define HSML_FACTOR_INV (1.0/HSML_FACTOR)
#endif

#ifdef SPH_KERNEL_C2
#ifndef TWODIMS
#define HSML_FACTOR     1.936492 /* Dehnen & Aly (2012) */
#else
#define HSML_FACTOR     1.897367
#endif
#define HSML_FACTOR_INV (1.0/HSML_FACTOR)
#define CORR_NORM       0.0294
#define CORR_EXP        0.977
#endif

#ifdef SPH_KERNEL_C4
#ifndef TWODIMS
#define HSML_FACTOR     2.207940
#else
#define HSML_FACTOR     2.171239
#endif
#define HSML_FACTOR_INV (1.0/HSML_FACTOR)
#define CORR_NORM       0.01342
#define CORR_EXP        1.579
#endif

#ifdef SPH_KERNEL_C6
#ifndef TWODIMS
#define HSML_FACTOR     2.449490
#else
#define HSML_FACTOR     2.415230
#endif
#define HSML_FACTOR_INV (1.0/HSML_FACTOR)
#define CORR_NORM       0.0116
#define CORR_EXP        2.236
#endif

#ifdef SPH_KERNEL_GADGET
#ifndef TWODIMS
#define KERNEL_COEFF_1 2.546479089470                 /*!< Coefficients for SPH spline kernel and its derivative */
#define KERNEL_COEFF_2 15.278874536822
#define KERNEL_COEFF_3 45.836623610466
#define KERNEL_COEFF_4 30.557749073644
#define KERNEL_COEFF_5 5.092958178941
#define KERNEL_COEFF_6 (-15.278874536822)
#else
#define KERNEL_COEFF_1 (5.0/7*2.546479089470)         /*!< Coefficients for SPH spline kernel and its derivative */
#define KERNEL_COEFF_2 (5.0/7*15.278874536822)
#define KERNEL_COEFF_3 (5.0/7*45.836623610466)
#define KERNEL_COEFF_4 (5.0/7*30.557749073644)
#define KERNEL_COEFF_5 (5.0/7*5.092958178941)
#define KERNEL_COEFF_6 (5.0/7*(-15.278874536822))
#endif
#endif

#ifdef SPH_KERNEL_CUBIC
#ifndef TWODIMS
#define KERNEL_COEFF_1 5.0929581789406511
#define KERNEL_COEFF_2 20.3718327157626042
#define KERNEL_COEFF_3 15.2788745368219523
#define KERNEL_COEFF_4 61.1154981472878092
#else
#define KERNEL_COEFF_1 3.637827270671893514
#define KERNEL_COEFF_2 14.5513090826875739
#define KERNEL_COEFF_3 10.9134818120156805
#define KERNEL_COEFF_4 43.6539272480627218
#endif
#endif

#ifdef SPH_KERNEL_QUARTIC
#ifndef TWODIMS
#define KERNEL_COEFF_1 9.7140468195736904
#define KERNEL_COEFF_2 48.5702340978684504
#define KERNEL_COEFF_3 97.1404681957369007
#define KERNEL_COEFF_4 38.8561872782947617
#define KERNEL_COEFF_5 194.2809363914738014
#define KERNEL_COEFF_6 388.5618727829476029
#else
#define KERNEL_COEFF_1 6.2221751104525387
#define KERNEL_COEFF_2 31.1108755522626943
#define KERNEL_COEFF_3 62.2217511045253886
#define KERNEL_COEFF_4 24.8887004418101547
#define KERNEL_COEFF_5 124.4435022090507772
#define KERNEL_COEFF_6 248.8870044181015544
#endif
#endif

#ifdef SPH_KERNEL_QUINTIC
#ifndef TWODIMS
#define KERNEL_COEFF_1 17.4035930270987542
#define KERNEL_COEFF_2 104.4215581625925324
#define KERNEL_COEFF_3 261.0538954064813311
#define KERNEL_COEFF_4 87.0179651354937818
#define KERNEL_COEFF_5 522.1077908129626621
#define KERNEL_COEFF_6 1305.2694770324067122
#else
#define KERNEL_COEFF_1 10.1945733213130794
#define KERNEL_COEFF_2 61.1674399278784762
#define KERNEL_COEFF_3 152.9185998196961975
#define KERNEL_COEFF_4 50.9728666065653968
#define KERNEL_COEFF_5 305.8371996393923951
#define KERNEL_COEFF_6 764.5929990984809592
#endif
#endif

#ifdef SPH_KERNEL_C2
#ifndef TWODIMS
#define KERNEL_COEFF_1 3.342253804929802
#else
#define KERNEL_COEFF_1 2.228169203286535
#endif
#endif

#ifdef SPH_KERNEL_C4
#ifndef TWODIMS
#define KERNEL_COEFF_1 1.641285350635171
#else
#define KERNEL_COEFF_1 0.954929658551372
#endif
#endif

#ifdef SPH_KERNEL_C6
#ifndef TWODIMS
#define KERNEL_COEFF_1 6.788953041263660
#else
#define KERNEL_COEFF_1 3.546881588905096
#endif
#endif
